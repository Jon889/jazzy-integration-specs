<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Siesta  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="Siesta  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">Siesta Docs</a> (96% documented)</p>
        <p class="header-right"><a href="https://github.com/bustoutsolutions/siesta"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">Siesta Reference</a>
        <img id="carat" src="img/carat.png" />
        Siesta  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Resources.html">Resources</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/Service.html">Service</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Resource.html">Resource</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Entity.html">Entity</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Error.html">Error</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Error/Cause.html">– Cause</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Configuration.html">Configuration</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Configuration/Builder.html">– Builder</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ConfigurationPatternConvertible.html">ConfigurationPatternConvertible</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/TypedContentAccessors.html">TypedContentAccessors</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Observering Resources.html">Observering Resources</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/ResourceObserver.html">ResourceObserver</a>
              </li>
              <li class="nav-group-task">
                <a href="Observering Resources.html#/s:6Siesta23ResourceObserverClosure">ResourceObserverClosure</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ResourceEvent.html">ResourceEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ResourceEvent/NewDataSource.html">– NewDataSource</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Requests.html">Requests</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Request.html">Request</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/RequestMethod.html">RequestMethod</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Response Parsing.html">Response Parsing</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/Response.html">Response</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ResponseTransformer.html">ResponseTransformer</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/TransformerSequence.html">TransformerSequence</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ResponseContentTransformer.html">ResponseContentTransformer</a>
              </li>
              <li class="nav-group-task">
                <a href="Response Parsing.html#/s:F6Siesta23JSONResponseTransformerFTSb_PS_19ResponseTransformer_">JSONResponseTransformer(_:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Response Parsing.html#/s:F6Siesta23TextResponseTransformerFTSb_PS_19ResponseTransformer_">TextResponseTransformer(_:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Response Parsing.html#/s:F6Siesta24ImageResponseTransformerFTSb_PS_19ResponseTransformer_">ImageResponseTransformer(_:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="UI Helpers.html">UI Helpers</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/ResourceStatusOverlay.html">ResourceStatusOverlay</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ResourceStatusOverlay/StateRule.html">– StateRule</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RemoteImageView.html">RemoteImageView</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Network Layer.html">Network Layer</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/NetworkingProvider.html">NetworkingProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/NetworkingProviderConvertible.html">NetworkingProviderConvertible</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/RequestNetworking.html">RequestNetworking</a>
              </li>
              <li class="nav-group-task">
                <a href="Network Layer.html#/s:6Siesta35RequestNetworkingCompletionCallback">RequestNetworkingCompletionCallback</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/RequestTransferMetrics.html">RequestTransferMetrics</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/NSURLSessionProvider.html">NSURLSessionProvider</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Caching.html">Caching</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/EntityCache.html">EntityCache</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/EntityEncoder.html">EntityEncoder</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/JSONEntityEncoder.html">JSONEntityEncoder</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Logging.html">Logging</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Logging.html#/s:v6Siesta20enabledLogCategoriesGVs3SetOS_11LogCategory_">enabledLogCategories</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/LogCategory.html">LogCategory</a>
              </li>
              <li class="nav-group-task">
                <a href="Logging.html#/s:v6Siesta6loggerFTOS_11LogCategorySS_T_">logger</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other Extensions.html">Other Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/NSRegularExpression.html">NSRegularExpression</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/NSURLSession.html">NSURLSession</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/NSURLSessionConfiguration.html">NSURLSessionConfiguration</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/String.html">String</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other Protocols.html">Other Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Other Protocols.html#/s:P6Siesta17NSJSONConvertible">NSJSONConvertible</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SessionTaskContainer.html">SessionTaskContainer</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <a href='#img-alt-siesta-src-https-bustoutsolutions-github-io-siesta-images-logo-2x-png-width-256-height-88' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='img-alt-siesta-src-https-bustoutsolutions-github-io-siesta-images-logo-2x-png-width-256-height-88'><img alt="Siesta" src="https://bustoutsolutions.github.io/siesta/images/logo@2x.png" width=256 height=88></h1>

<p><strong>iOS REST Client Framework</strong></p>

<p><a href="https://travis-ci.org/bustoutsolutions/siesta"><img src="https://travis-ci.org/bustoutsolutions/siesta.svg" alt="Build Status"></a>
<a href="https://github.com/bustoutsolutions/siesta/releases"><img src="https://img.shields.io/cocoapods/v/Siesta.svg" alt="CocoaPods"></a>
<a href="https://github.com/bustoutsolutions/siesta/releases"><img src="https://img.shields.io/badge/Carthage-compatible-5b9dd9.svg" alt="Carthage compatible"></a>
<a href="https://github.com/bustoutsolutions/siesta/blob/master/LICENSE"><img src="https://img.shields.io/github/license/mashape/apistatus.svg" alt="GitHub license"></a>
<a href="https://twitter.com/siestaframework"><img src="https://img.shields.io/badge/Twitter-@siestaframework-f26430.svg" alt="Twitter: @siestaframework"></a></p>

<p>Drastically simplifies app code by providing a client-side cache of observable models for RESTful resources.</p>

<ul>
<li><strong>OS:</strong> iOS 8+</li>
<li><strong>Languages:</strong> Written in Swift, supports apps in both Swift and Objective-C</li>
<li><strong>Tool requirements:</strong> Xcode 7, Swift 2.0</li>
<li><strong>License:</strong> MIT</li>
<li><strong>Status:</strong> Solid code, already in use on the App Store, but still classified as “beta” so we can gather feedback before locking in the API for the official 1.0 release. Please kick the tires, file issues, and send pull requests. Be bold!</li>
</ul>
<a href='#contents' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='contents'>Contents</h3>

<ul>
<li><a href="#what%E2%80%99s-it-for">What’s It For?</a></li>
<li><a href="#features">Features</a></li>
<li><a href="#origin">Origin</a></li>
<li><a href="#design-philosophy">Design Philosophy</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#basic-usage">Basic Usage</a></li>
<li><a href="#comparison-with-other-frameworks">Comparison With Other Frameworks</a></li>
<li>Documentation

<ul>
<li><a href="https://bustoutsolutions.github.io/siesta/guide/">User Guide</a></li>
<li><a href="https://bustoutsolutions.github.io/siesta/api/">API Docs</a></li>
<li><a href="https://bustoutsolutions.github.io/siesta/specs/">Specs</a></li>
</ul></li>
<li><a href="#examples">Examples</a></li>
<li><a href="#contributing-and-getting-help">Contributing and Getting Help</a></li>
</ul>
<a href='#what-s-it-for' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='what-s-it-for'>What’s It For?</h2>
<a href='#the-problem' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='the-problem'>The Problem</h3>

<p>Want your app to talk to a remote API? Welcome to your state nightmare!</p>

<p>You need to display response data whenever it arrives. Unless the requesting screen is no longer visible. Unless some other currently visible bit of UI happens to need the same data. Or is about to need it.</p>

<p>You should show a loading indicator (but watch out for race conditions that leave it stuck spinning forever), display user-friendly errors (but not redundantly — no modal alert dogpiles!), give users a retry mechanism … and hide all of that when a subsequent request succeeds.</p>

<p>Be sure to avoid redundant requests — and redundant response deserialization. Deserialization should be on a background thread, of course. Oh, and remember not to retain your ViewController / model / helper thingy by accident in your callback closures. Unless you’re supposed to.</p>

<p>Naturally you’ll want to rewrite all of this from scratch in a slightly different ad hoc way for every project you create.</p>

<p>What could possibly go wrong?</p>
<a href='#the-solution' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='the-solution'>The Solution</h3>

<p>Siesta ends this headache by providing a <strong>resource-centric</strong> alternative to the familiar <strong>request-centric</strong> approach.</p>

<p>Siesta provides an app-wide observable model of a RESTful resource’s state. This model answers three basic questions:</p>

<ul>
<li>What is the latest data for this resource, if any?</li>
<li>Did the latest request result in an error?</li>
<li>Is there a request in progress?</li>
</ul>

<p>…and broadcasts notifications whenever the answers to these questions change.</p>

<p>Siesta handles all the transitions and corner cases to deliver these answers wrapped up with a pretty bow on top, letting you focus on your logic and UI.</p>
<a href='#features' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='features'>Features</h2>

<ul>
<li>Decouples view, model, and controller lifecycle from network request lifecycle</li>
<li>Decouples request initiation from request configuration</li>
<li>Eliminates error-prone state tracking logic</li>
<li>Eliminates redundant network requests</li>
<li>Unified handling for all errors: encoding, network, server-side, and parsing</li>
<li>Highly extensible, multithreaded response deserialization</li>
<li>Transparent built-in parsing (which you can turn off) for JSON, text, and images</li>
<li>Smooth progress reporting that accounts for upload, download, <em>and</em> latency</li>
<li>Transparent Etag / If-Modified-Since handling</li>
<li>Prebaked UI helpers for loading &amp; error handling, remote images</li>
<li>Debug-friendly, customizable logging</li>
<li>Written in Swift with a great <a href="https://bustoutsolutions.github.io/siesta/api/">Swift-centric API</a>, but…</li>
<li>…also works great from Objective-C thanks to a compatibility layer.</li>
<li>Lightweight. Won’t achieve sentience and attempt to destroy you.</li>
<li><a href="https://bustoutsolutions.github.io/siesta/specs/">Robust regression tests</a></li>
<li><a href="https://bustoutsolutions.github.io/siesta/guide/">Documentation</a> and <a href="http://bustoutsolutions.github.io/siesta/api/">more documentation</a></li>
</ul>
<a href='#what-it-doesn-t-do' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='what-it-doesn-t-do'>What it doesn’t do</h3>

<ul>
<li>It <strong>doesn’t reinvent networking.</strong> Siesta delegates network operations to your library of choice (<code>NSURLSession</code> by default, or <a href="https://github.com/Alamofire/Alamofire">Alamofire</a>, or inject your own <a href="http://bustoutsolutions.github.io/siesta/api/Protocols/NetworkingProvider.html">custom adapter</a>).</li>
<li>It <strong>doesn’t hide HTTP</strong>. On the contrary, Siesta strives to expose the full richness of HTTP while providing conveniences to simplify common usage patterns. You can devise an abstraction layer to suit your own particular needs, or work directly with Siesta’s nice APIs for requests and response entities.</li>
<li>It <strong>doesn’t do automatic response ↔ model mapping.</strong> This means that Siesta doesn’t constrain your response models, or force you to have any at all. Add a response transformer to output models of whatever flavor you prefer, or work directly with parsed JSON.</li>
</ul>
<a href='#origin' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='origin'>Origin</h2>

<p>This project started as helper code we wrote out of practical need on several <a href="http://bustoutsolutions.com">Bust Out Solutions</a> projects. When we found ourselves copying the code between projects, we knew it was time to open source it.</p>

<p>For the open source transition, we took the time to rewrite our code in Swift — and <em>rethink</em> it in Swift, embracing the language to make the API as clean as the concepts.</p>

<p>Siesta’s code is therefore both old and new: battle-tasted on the App Store, then reincarnated in a Swifty green field.</p>
<a href='#design-philosophy' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='design-philosophy'>Design Philosophy</h2>

<p>Make the default thing the right thing most of the time.</p>

<p>Make the right thing easy all of the time.</p>

<p>Build from need. Don’t invent solutions in search of problems.</p>

<p>Design the API with these goals:</p>

<ol>
<li>Make client code easy to <strong>read</strong>.</li>
<li>Make client code easy to <strong>write</strong>.</li>
<li>Keep the API clean.</li>
<li>Keep the implementation tidy.</li>
</ol>

<p><em>…in that order of priority.</em></p>

<hr>
<a href='#installation' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='installation'>Installation</h2>

<p>Siesta requires Swift 2.0, so make sure you have <a href="https://developer.apple.com/xcode/downloads/">Xcode 7</a>.</p>
<a href='#cocoapods' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='cocoapods'>CocoaPods</h3>

<p>In your <code>Podfile</code>:</p>
<pre class="highlight plaintext"><code>pod 'Siesta', '&gt;=1.0-beta.6'
</code></pre>

<p>If you want to use Alamofire as your networking provider instead of <code>NSURLSession</code>:</p>
<pre class="highlight plaintext"><code>pod 'Siesta/Alamofire'
</code></pre>

<p>(You’ll also need to pass an <code>Alamofire.Manager</code> when you configure your <code>Siesta.Service</code>. See the <a href="http://bustoutsolutions.github.io/siesta/api/Classes/Service.html#/s:FC6Siesta7ServicecFMS0_FT4baseGSqSS_22useDefaultTransformersSb18networkingProviderPS_18NetworkingProvider__S0_">API docs</a> for more info.)</p>
<a href='#carthage' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='carthage'>Carthage</h3>

<p>In your <code>Cartfile</code>:</p>
<pre class="highlight plaintext"><code>github "bustoutsolutions/siesta" "1.0-beta.6"
</code></pre>

<p>Follow the <a href="https://github.com/Carthage/Carthage#adding-frameworks-to-an-application">Carthage instructions</a> to add <code>Siesta.framework</code> to your project.</p>

<p>As of this writing, there is one additional step you need to follow for Xcode 7 that isn’t in the Carthage docs:</p>

<ul>
<li>Build settings → Framework search paths → <code>$(PROJECT_DIR)/Carthage/Build/iOS/</code></li>
</ul>

<p>(In-depth discussion of Carthage on XC7 is <a href="https://github.com/Carthage/Carthage/issues/536">here</a>.)</p>

<p>The code in <code>Extensions/</code> is <em>not</em> part of the <code>Siesta.framework</code> that Carthage builds. (This currently includes only Alamofire support.) You will need to include those source files in your project manually if you want to use them.</p>
<a href='#git-submodule' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='git-submodule'>Git Submodule</h3>

<p>Clone Siesta as a submodule into the directory of your choice, in this case Libraries/Siesta:
<code>
git submodule add https://github.com/bustoutsolutions/siesta.git Libraries/Siesta
git submodule update --init
</code></p>

<p>Drag <code>Siesta.xcodeproj</code> into your project tree as a subproject.</p>

<p>Under your project&rsquo;s Build Phases, expand Target Dependencies. Click the + button and add Siesta.</p>

<p>Expand the Link Binary With Libraries phase. Click the + button and add Siesta.</p>

<p>Click the + button in the top left corner to add a Copy Files build phase. Set the directory to Frameworks. Click the + button and add Siesta.</p>

<hr>
<a href='#basic-usage' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='basic-usage'>Basic Usage</h2>

<p>Make a shared service instance for the REST API you want to use:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">MyAPI</span> <span class="o">=</span> <span class="kt">Service</span><span class="p">(</span><span class="nv">baseURL</span><span class="p">:</span> <span class="s">"https://api.example.com"</span><span class="p">)</span>
</code></pre>

<p>Now register your view controller — or view, or anything you like — to receive notifications whenever a particular resource’s state changes:</p>
<pre class="highlight swift"><code><span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

    <span class="kt">MyAPI</span><span class="o">.</span><span class="nf">resource</span><span class="p">(</span><span class="s">"/profile"</span><span class="p">)</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="k">self</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>Use those notifications to populate your UI:</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">resourceChanged</span><span class="p">(</span><span class="nv">resource</span><span class="p">:</span> <span class="kt">Resource</span><span class="p">,</span> <span class="nv">event</span><span class="p">:</span> <span class="kt">ResourceEvent</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">nameLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">jsonDict</span><span class="p">[</span><span class="s">"name"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span>
    <span class="n">colorLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">jsonDict</span><span class="p">[</span><span class="s">"favoriteColor"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span>

    <span class="n">errorLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">latestError</span><span class="p">?</span><span class="o">.</span><span class="n">userMessage</span>
<span class="p">}</span>
</code></pre>

<p>Or if you don’t like delegates, Siesta supports closure observers:</p>
<pre class="highlight swift"><code><span class="kt">MyAPI</span><span class="o">.</span><span class="nf">resource</span><span class="p">(</span><span class="s">"/profile"</span><span class="p">)</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="nv">owner</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">resource</span><span class="p">,</span> <span class="n">_</span> <span class="k">in</span>

    <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">nameLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">jsonDict</span><span class="p">[</span><span class="s">"name"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span>
    <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">colorLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">jsonDict</span><span class="p">[</span><span class="s">"favoriteColor"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span>

    <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">errorLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">latestError</span><span class="p">?</span><span class="o">.</span><span class="n">userMessage</span>
<span class="p">}</span>
</code></pre>

<p>Note that no actual JSON parsing occurs when we invoke <code>jsonDict</code>. The JSON has already been parsed off the main thread, in a GCD queue — and unlike other frameworks, it is only parsed <em>once</em> no matter how many observers there are.</p>

<p>Of course, you probably don’t want to work with raw JSON in all your controllers. You can configure Siesta to automatically turn raw responses into models:</p>
<pre class="highlight swift"><code><span class="kt">MyAPI</span><span class="o">.</span><span class="nf">configureTransformer</span><span class="p">(</span><span class="s">"/profile"</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// Path supports wildcards</span>
    <span class="kt">UserProfile</span><span class="p">(</span><span class="nv">json</span><span class="p">:</span> <span class="nv">$0</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>         <span class="c1">// Create models however you like</span>
<span class="p">}</span>
</code></pre>

<p>…and now your observers see models instead of JSON:</p>
<pre class="highlight swift"><code><span class="kt">MyAPI</span><span class="o">.</span><span class="nf">resource</span><span class="p">(</span><span class="s">"/profile"</span><span class="p">)</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="nv">owner</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">resource</span><span class="p">,</span> <span class="n">_</span> <span class="k">in</span>
    <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="nf">showProfile</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="nf">typedContent</span><span class="p">())</span>  <span class="c1">// Response now contains UserProfile instead of JSON</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">showProfile</span><span class="p">(</span><span class="nv">profile</span><span class="p">:</span> <span class="kt">UserProfile</span><span class="p">?)</span> <span class="p">{</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre>

<p>Trigger a staleness-aware, redundant-request-suppressing load when the view appears:</p>
<pre class="highlight swift"><code><span class="k">override</span> <span class="kd">func</span> <span class="nf">viewWillAppear</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">MyAPI</span><span class="o">.</span><span class="nf">resource</span><span class="p">(</span><span class="s">"/profile"</span><span class="p">)</span><span class="o">.</span><span class="nf">loadIfNeeded</span><span class="p">()</span>
<span class="p">}</span>
</code></pre>

<p>…and you have a networked UI.</p>

<p>Add a loading indicator:</p>
<pre class="highlight swift"><code><span class="kt">MyAPI</span><span class="o">.</span><span class="nf">resource</span><span class="p">(</span><span class="s">"/profile"</span><span class="p">)</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="nv">owner</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">resource</span><span class="p">,</span> <span class="n">event</span> <span class="k">in</span>

    <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">activityIndicator</span><span class="o">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="o">!</span><span class="n">resource</span><span class="o">.</span><span class="n">isLoading</span>
<span class="p">}</span>
</code></pre>

<p>…or better yet, use Siesta’s prebaked <code>ResourceStatusOverlay</code> view to get an activity indicator, a nicely formatted error message, and a retry button for free:</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">ProfileViewController</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">,</span> <span class="kt">ResourceObserver</span> <span class="p">{</span>
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">nameLabel</span><span class="p">,</span> <span class="nv">colorLabel</span><span class="p">:</span> <span class="kt">UILabel</span><span class="o">!</span>

    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">statusOverlay</span><span class="p">:</span> <span class="kt">ResourceStatusOverlay</span><span class="o">!</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

        <span class="kt">MyAPI</span><span class="o">.</span><span class="nf">resource</span><span class="p">(</span><span class="s">"/profile"</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="k">self</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="n">statusOverlay</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewWillAppear</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewWillAppear</span><span class="p">(</span><span class="n">animated</span><span class="p">)</span>
        <span class="kt">MyAPI</span><span class="o">.</span><span class="nf">resource</span><span class="p">(</span><span class="s">"/profile"</span><span class="p">)</span><span class="o">.</span><span class="nf">loadIfNeeded</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">resourceChanged</span><span class="p">(</span><span class="nv">resource</span><span class="p">:</span> <span class="kt">Resource</span><span class="p">,</span> <span class="nv">event</span><span class="p">:</span> <span class="kt">ResourceEvent</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">nameLabel</span><span class="o">.</span><span class="n">text</span>  <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">jsonDict</span><span class="p">[</span><span class="s">"name"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span>
        <span class="n">colorLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">jsonDict</span><span class="p">[</span><span class="s">"favoriteColor"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>Note that this example is not toy code. Together with its storyboard, <strong>this small class is a fully armed and operational REST-backed user interface</strong>.</p>
<a href='#your-socks-still-on' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='your-socks-still-on'>Your socks still on?</h3>

<p>Take a look at AFNetworking’s venerable <code>UIImageView</code> extension for asynchronously loading and caching remote images on demand. Seriously, go <a href="https://github.com/AFNetworking/AFNetworking/blob/master/UIKit%2BAFNetworking/UIImageView%2BAFNetworking.m">skim that code</a> and digest all the cool things it does. Take a few minutes. I’ll wait. I’m a README. I’m not going anywhere.</p>

<p>Got it? Good.</p>

<p>Here’s how you implement the same functionality using Siesta:</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">RemoteImageView</span><span class="p">:</span> <span class="kt">UIImageView</span> <span class="p">{</span>
  <span class="kd">static</span> <span class="k">var</span> <span class="nv">imageCache</span><span class="p">:</span> <span class="kt">Service</span> <span class="o">=</span> <span class="kt">Service</span><span class="p">()</span>

  <span class="k">var</span> <span class="nv">placeholderImage</span><span class="p">:</span> <span class="kt">UIImage</span><span class="p">?</span>

  <span class="k">var</span> <span class="nv">imageURL</span><span class="p">:</span> <span class="kt">NSURL</span><span class="p">?</span> <span class="p">{</span>
    <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">imageResource</span><span class="p">?</span><span class="o">.</span><span class="n">url</span> <span class="p">}</span>
    <span class="k">set</span> <span class="p">{</span> <span class="n">imageResource</span> <span class="o">=</span> <span class="kt">RemoteImageView</span><span class="o">.</span><span class="n">imageCache</span><span class="o">.</span><span class="nf">resource</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">newValue</span><span class="p">)</span> <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">var</span> <span class="nv">imageResource</span><span class="p">:</span> <span class="kt">Resource</span><span class="p">?</span> <span class="p">{</span>
    <span class="k">willSet</span> <span class="p">{</span>
      <span class="n">imageResource</span><span class="p">?</span><span class="o">.</span><span class="nf">removeObservers</span><span class="p">(</span><span class="nv">ownedBy</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>
      <span class="n">imageResource</span><span class="p">?</span><span class="o">.</span><span class="nf">cancelLoadIfUnobserved</span><span class="p">(</span><span class="nv">afterDelay</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">didSet</span> <span class="p">{</span>
      <span class="n">imageResource</span><span class="p">?</span><span class="o">.</span><span class="nf">loadIfNeeded</span><span class="p">()</span>
      <span class="n">imageResource</span><span class="p">?</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="nv">owner</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">_</span> <span class="k">in</span>
        <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">imageResource</span><span class="p">?</span><span class="o">.</span><span class="nf">contentAsType</span><span class="p">(</span><span class="nv">ifNone</span><span class="p">:</span> <span class="n">placeholderImage</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>A thumbnail of both versions, for your code comparing pleasure:</p>

<p align="center"><img alt="Code comparison" src="https://bustoutsolutions.github.io/siesta/guide/images/code-comparison@2x.png" width=388 height=628></p>

<p>The same functionality. Yes, really.</p>

<p><small>(Well, OK, they’re not <em>exactly</em> identical. The Siesta version has more robust caching behavior, and will transparently update an image everywhere it is displayed if it’s refreshed.)</small></p>

<p>There’s a more featureful version of <code>RemoteImageView</code> <a href="http://bustoutsolutions.github.io/siesta/api/Classes/RemoteImageView.html">already included with Siesta</a> — but the UI freebies aren’t the point. “Less code” isn’t even the point. The point is that Siesta gives you an <strong>elegant abstraction</strong> that <strong>solves problems you actually have</strong>, making your code <strong>simpler and less brittle</strong>.</p>
<a href='#comparison-with-other-frameworks' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='comparison-with-other-frameworks'>Comparison With Other Frameworks</h2>

<p>Popular REST / networking frameworks have different primary goals:</p>

<ul>
<li><a href="https://developer.apple.com/library/ios/documentation/Foundation/Reference/NSURLSession_class/">NSURLSession</a> is Apple’s standard iOS HTTP library (and is all most projects need).</li>
<li><a href="http://bustoutsolutions.github.io/siesta/">Siesta</a> untangles state problems with an observable resource cache.</li>
<li><a href="https://github.com/Alamofire/Alamofire">Alamofire</a> provides a Swifty, modern-feeling wrapper for NSURLSession.</li>
<li><a href="https://github.com/Moya/Moya">Moya</a> wraps Alamofire to hide HTTP URLs and parameters.</li>
<li><a href="https://github.com/RestKit/RestKit">RestKit</a> couples HTTP with JSON ↔ object model ↔ Core Data mapping.</li>
<li><a href="https://github.com/AFNetworking/AFNetworking">AFNetworking</a> is a modern-feeling Obj-C wrapper for Apple’s network APIs, plus a suite of related utilities.</li>
</ul>

<p>Which one is right for your project? It depends on your needs and your tastes.</p>

<p>Siesta has robust functionality, but does not attempt to solve everything. In particular, Moya and RestKit address complementary / alternative concerns, while Alamofire and AFNetworking provide more robust low-level HTTP support. Further complicating a comparison, some frameworks are built on top of others. When you use Moya, for example, you’re also signing up for Alamofire.</p>

<p>With all that in mind, here is a capabilities comparison¹:</p>

<table><thead>
<tr>
<th style="text-align: left"></th>
<th style="text-align: center">Siesta</th>
<th style="text-align: center">Alamofire</th>
<th style="text-align: center">RestKit</th>
<th style="text-align: center">Moya</th>
<th style="text-align: center">AFNetworking</th>
<th style="text-align: center">NSURLSession</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: left">HTTP requests</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td style="text-align: left">Async response callbacks</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
</tr>
<tr>
<td style="text-align: left">Observable in-memory cache</td>
<td style="text-align: center">✓</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: left">Prevents redundant requests</td>
<td style="text-align: center">✓</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: left">Prevents redundant parsing</td>
<td style="text-align: center">✓</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: left">Parsing for common formats</td>
<td style="text-align: center">✓</td>
<td style="text-align: center">✓</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center">✓</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: left">Route-based parsing</td>
<td style="text-align: center">✓</td>
<td style="text-align: center"></td>
<td style="text-align: center">✓</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: left">Content-type-based parsing</td>
<td style="text-align: center">✓</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: left">File upload/download tasks</td>
<td style="text-align: center"></td>
<td style="text-align: center">✓</td>
<td style="text-align: center">~</td>
<td style="text-align: center"></td>
<td style="text-align: center">✓</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: left">Object model mapping</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center">✓</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: left">Core data integration</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center">✓</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: left">Hides HTTP</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center">✓</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: left">UI helpers</td>
<td style="text-align: center">✓</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center">✓</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: left">Primary language</td>
<td style="text-align: center">Swift</td>
<td style="text-align: center">Swift</td>
<td style="text-align: center">Obj-C</td>
<td style="text-align: center">Swift</td>
<td style="text-align: center">Obj-C</td>
<td style="text-align: center">Obj-C</td>
</tr>
<tr>
<td style="text-align: left">Nontrivial lines of code²</td>
<td style="text-align: center">2013</td>
<td style="text-align: center">1695</td>
<td style="text-align: center">10651</td>
<td style="text-align: center">557</td>
<td style="text-align: center">4055</td>
<td style="text-align: center">?</td>
</tr>
<tr>
<td style="text-align: left">Built on top of</td>
<td style="text-align: center"><small>any (injectable)</small></td>
<td style="text-align: center"><small>NSURLSession</small></td>
<td style="text-align: center"><small>AFNetworking</small></td>
<td style="text-align: center"><small>Alamofire</small></td>
<td style="text-align: center"><small>NSURLSession / NSURLConnection</small></td>
<td style="text-align: center"><small>Apple guts</small></td>
</tr>
</tbody></table>

<p><small>1. Disclaimer: table compiled by Siesta’s non-omniscient author. Corrections / additions? Please <a href="https://github.com/bustoutsolutions/siesta/edit/master/README%2Emd#L280">submit a PR</a>.</small>
<br>
<small>2. “Trivial” means lines containing only whitespace, comments, parens, semicolons, and braces.</small></p>

<p>Despite this capabilities list, Siesta is a relatively small codebase — about the same size as Alamofire, and 5.5x smaller than RestKit.</p>
<a href='#what-sets-siesta-apart' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='what-sets-siesta-apart'>What sets Siesta apart?</h3>

<p>It’s not just the features. Siesta <strong>solves a different problem</strong> than other REST frameworks.</p>

<p>Other frameworks essentially view HTTP as a form of <a href="https://en.wikipedia.org/wiki/Remote_procedure_call">RPC</a>. New information arrives only in responses that are coupled to requests — the return values of asynchronous functions.</p>

<p>Siesta <strong>puts the the “ST” back in “REST”</strong>, embracing the notion of <em>state transfer</em> as an architectural principle, and decoupling the act of <em>observing</em> state from the act of <em>transferring</em> it.</p>

<p>If that approach sounds appealing, give Siesta a try.</p>

<hr>
<a href='#documentation' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='documentation'>Documentation</h2>

<ul>
<li><strong><a href="https://bustoutsolutions.github.io/siesta/guide/">User Guide</a></strong></li>
<li><strong><a href="https://bustoutsolutions.github.io/siesta/api/">API documentation</a></strong></li>
<li><strong><a href="https://bustoutsolutions.github.io/siesta/specs/">Specs</a></strong></li>
</ul>
<a href='#examples' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='examples'>Examples</h2>

<p>This repo includes a <a href="https://github.com/bustoutsolutions/siesta/tree/master/Examples/GithubBrowser">simple example project</a>. Use Carthage to build its dependencies.</p>
<a href='#contributing-and-getting-help' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='contributing-and-getting-help'>Contributing and Getting Help</h2>

<p>To report a bug, <a href="https://github.com/bustoutsolutions/siesta/issues/new">file an issue</a>.</p>

<p>To point out anything incorrect or confusing in the documentation, <a href="https://github.com/bustoutsolutions/siesta/issues/new">file an issue</a>.</p>

<p>To submit a feature request / cool idea, <a href="https://github.com/bustoutsolutions/siesta/issues/new">file an issue</a>.</p>

<p>To get help, post your question to <a href="https://stackoverflow.com">Stack Overflow</a> and tag it with <strong>siesta-swift</strong>. (Be sure to include the tag. It triggers a notification.)</p>
<a href='#pull-requests' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='pull-requests'>Pull Requests</h3>

<p>Want to <em>do</em> something instead of just talking about it? Fantastic! Be bold.</p>

<ul>
<li>If you have trouble building or testing the project, please file an issue about it — even if you resolve the problem. This will help improve the docs.</li>
<li>If you are proposing a design change or nontrivial new functionality, please float your idea as an issue first so you don’t end up doing wasted work.</li>
<li>Please follow the formatting conventions of the existing code. Yes, including Paul’s idiosyncratic taste in brace placement.</li>
<li>Please make sure the tests pass locally before pushing (cmd-U in Xcode).</li>
<li>Expect a little back and forth on your PR before it’s accepted. Don’t be discouraged. Nit-picking is not a sign of bad work; it’s a sign of interest!</li>
<li>If you want to update the user guide, note that the guide is generated from the <code>Docs</code> directory in <code>master</code>, so that’s where you should make your change. Do not submit pull requests against <code>gh-pages</code>.</li>
</ul>

          </section>
        </section>
        <section id="footer">
          <p>© 2016 <a class="link" href="http://bustoutsolutions.com" target="_blank" rel="external">Bust Out Solutions</a> under <a class="link" href="https://github.com/bustoutsolutions/siesta/blob/master/LICENSE" target="_blank" rel="external">open source license</a>.</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ vX.X.X</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
